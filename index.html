<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Questions Chat</title>
		<style>
			body {
				margin: 0;
				padding-bottom: 3rem;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
					Helvetica, Arial, sans-serif;
				background-color: #18181b;
				color: white;
			}

			button {
				display: flex;
				justify-content: center;
				align-items: center;
			}

			#ask {
				width: minmax(15%, 100px);
			}

			#emote {
				width: minmax(15%, 100px);
			}

			.question {
				text-align: center;
				background-color: #4064ac;
			}

			.user {
				text-align: center;
				color: white;
			}

			#emotes {
				background-color: #0E0E10;
				height: 20rem;
				position: fixed;
				bottom: 0;
				right: 0;
				border-radius: 15px;
				margin-right: 15px;
				overflow-y: scroll;
				width: 70%;
				display: none;
			}

			#form {
				background: rgba(0, 0, 0, 0.15);
				padding: 0.25rem;
				position: fixed;
				bottom: 0;
				left: 0;
				right: 0;
				display: flex;
				height: 3rem;
				box-sizing: border-box;
				backdrop-filter: blur(10px);
			}

			#input {
				border: none;
				padding: 0 1rem;
				border-radius: 2rem;
				margin: 0.25rem;
				background-color: black;
				color: white;
				border: 2px solid #4064ac;
				width: 100%;
			}

			#input:focus {
				outline: none;
			}

			#form > button {
				background: #4064ac;
				border: none;
				padding: 0 1rem;
				margin: 0.25rem;
				border-radius: 3px;
				outline: none;
				color: #fff;
			}

			#form > span {
				display: flex;
			}

			#form > span > button {
				background: #4064ac;
				border: none;
				padding: 0 1rem;
				margin: 0.25rem;
				border-radius: 3px;
				outline: none;
				color: #fff;
			}

			#messages {
				list-style-type: none;
				margin: 0;
				padding: 0;
			}
			#messages > li {
				padding: 0.5rem 1rem;
			}

		</style>
	</head>
	<body>
		<ul id="messages"></ul>
		<div id="emotes">
			<img src="/images/1.png" alt="">
			<img src="/images/2.png" alt="">
		</div>
		<form id="form" action="">
			<button id="ask">
				<img src="./live_help-white-18dp.svg" alt="ask">
			</button>
			<input id="input" autocomplete="off"> 
			</input>
				<button id="emote">
					<img src="./insert_emoticon-white-18dp.svg" alt="emote"/>
				</button>
				<button>
					<img id="send" src="./send-white-18dp.svg" alt="send" />
				</button>
		</form>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var userName = ''
			do {
				userName = prompt('enter username: ')
			} while (!userName)

			var socket = io()
			socket.emit('user', userName)

			var form = document.getElementById('form')
			var input = document.getElementById('input')
			var ask = document.getElementById('ask')
			var emote = document.getElementById('emote')
			var emotes = document.getElementById('emotes')

			emotes.addEventListener('click', () => {
			})

			form.addEventListener('submit', e => {
				e.preventDefault()
				if (input.value) {
					socket.emit('chat message', { userName, message: input.value })
					input.value = ''
				}
			})

			ask.addEventListener('click', e => {
				e.preventDefault()
				socket.emit('question')
			})

			emote.addEventListener('click', e => {
				if (emotes.style.display === "block") {
					emotes.style.display = 'none'
				} else {
					emotes.style.display = 'block'
				}
				// e.preventDefault()
				// socket.emit('emote', 'nini')
			})

			socket.on('chat message', msg => {
				var item = document.createElement('li')
				item.innerHTML += `<strong>${msg.userName}</strong>:  ${msg.message}`
				messages.appendChild(item)
				window.scrollTo(0, document.body.scrollHeight)
			})

			socket.on('user', userName => {
				var item = document.createElement('li')
				item.innerHTML += `<strong>${userName}</strong> has entered the chat.`
				item.setAttribute('class', 'user')
				messages.appendChild(item)
				window.scrollTo(0, document.body.scrollHeight)
			})

			socket.on('question', question => {
				var item = document.createElement('li')
				item.innerHTML += `<strong>${question}</strong>`
				item.setAttribute('class', 'question')
				messages.appendChild(item)
				window.scrollTo(0, document.body.scrollHeight)
			})

			socket.on('disconnection', userName => {
				var item = document.createElement('li')
				item.innerHTML += `<strong>${userName}</strong> has left the chat.`
				item.setAttribute('class', 'user')
				messages.appendChild(item)
				window.scrollTo(0, document.body.scrollHeight)
			})

			socket.on('img', emote => {
				var item = document.createElement('li')
				item.innerHTML += `<img src="${emote}.png" />`
				messages.appendChild(item)
				window.scrollTo(0, document.body.scrollHeight)
			})
		</script>
	</body>
</html>
